/*!
 * Bootstrap Markdown Editor v2.0.2 (https://github.com/inacho/bootstrap-markdown-editor)
 * Copyright 2019 Ignacio de Tom√°s <nacho@inacho.es>
 * Licensed under MIT (https://github.com/inacho/bootstrap-markdown-editor/blob/master/LICENSE)
 */

!function(u){"use strict";function f(t,e,a,i,n){if(e.length){n.show();var o=new FormData,s=0;for(s=0;s<e.length;s++)o.append("file"+s,e[s]);u.ajax({url:t,type:"POST",contentType:!1,data:o,processData:!1,cache:!1,dataType:"json"}).done(function(t){var e="";1<t.length&&(e="\n");for(var n=0;n<t.length;n++)i.insertSnippet(a,"![]("+t[n]+")"+e)}).always(function(){n.hide()})}}function g(t){var e,n=u(window).height(),a=t.offset().top;a<n&&(e=n-a,t.css("height",e+"px"))}function v(t,e){0===t.getCursorPosition().column?(t.navigateLineStart(),t.insert(e+" ")):(t.navigateLineStart(),t.insert(e+" "),t.navigateLineEnd())}var e={init:function(t){var n,e,a,i,o=u.extend(!0,{},u.fn.markdownEditor.defaults,t),s=this,d=!1,l=!1;s.addClass("md-textarea-hidden"),n=u("<div/>"),s.after(n),n.addClass("md-container").html((e=s.val(),i="",i+='<div class="md-loading"><span class="md-icon-container"><span class="md-icon"></span></span></div>',i+='<div class="md-toolbar">',i+='<div class="btn-toolbar">',i+='<div class="btn-group md-toolbar-header mr-2">',i+='<button type="button" data-mdtooltip="tooltip" title="'+(a=o).label.btnHeader1+'" class="md-btn btn btn-sm btn-secondary" data-btn="h1">H1</button>',i+='<button type="button" data-mdtooltip="tooltip" title="'+a.label.btnHeader2+'" class="md-btn btn btn-sm btn-secondary" data-btn="h2">H2</button>',i+='<button type="button" data-mdtooltip="tooltip" title="'+a.label.btnHeader3+'" class="md-btn btn btn-sm btn-secondary" data-btn="h3">H3</button>',i+="</div>",i+='<div class="btn-group md-toolbar-text-style mr-2">',i+='<button type="button" data-mdtooltip="tooltip" title="'+a.label.btnBold+'" class="md-btn btn btn-sm btn-secondary" data-btn="bold"><span class="fas fa-bold"></span></button>',i+='<button type="button" data-mdtooltip="tooltip" title="'+a.label.btnItalic+'" class="md-btn btn btn-sm btn-secondary" data-btn="italic"><span class="fas fa-italic"></span></button>',i+="</div>",i+='<div class="btn-group md-toolbar-list mr-2">',i+='<button type="button" data-mdtooltip="tooltip" title="'+a.label.btnList+'" class="md-btn btn btn-sm btn-secondary" data-btn="ul"><span class="fas fa-list-ul"></span></button>',i+='<button type="button" data-mdtooltip="tooltip" title="'+a.label.btnOrderedList+'" class="md-btn btn btn-sm btn-secondary" data-btn="ol"><span class="fas fa-list-ol"></span></button>',i+="</div>",i+='<div class="btn-group md-toolbar-url mr-auto">',i+='<button type="button" data-mdtooltip="tooltip" title="'+a.label.btnLink+'" class="md-btn btn btn-sm btn-secondary" data-btn="link"><span class="fas fa-link"></span></button>',i+='<button type="button" data-mdtooltip="tooltip" title="'+a.label.btnImage+'" class="md-btn btn btn-sm btn-secondary" data-btn="image"><span class="fas fa-image"></span></button>',!0===a.imageUpload&&(i+='<div data-mdtooltip="tooltip" title="'+a.label.btnUpload+'" class="btn btn-sm btn-secondary md-btn-file"><span class="fas fa-file-upload"></span><input class="md-input-upload" type="file" multiple accept=".jpg,.jpeg,.png,.gif"></div>'),i+="</div>",!0===a.fullscreen&&(i+='<div class="btn-group md-toolbar-fullscreen mr-2">',i+='<button type="button" class="md-btn btn btn-sm btn-secondary" data-btn="fullscreen"><span class="fas fa-expand"></span> '+a.label.btnFullscreen+"</button>",i+="</div>"),!0===a.preview&&(i+='<div class="btn-group md-toolbar-preview">',i+='<button type="button" class="md-btn btn btn-sm btn-secondary btn-edit active" data-btn="edit"><span class="fas fa-edit"></span> '+a.label.btnEdit+"</button>",i+='<button type="button" class="md-btn btn btn-sm btn-secondary btn-preview" data-btn="preview"><span class="fas fa-eye"></span> '+a.label.btnPreview+"</button>",i+="</div>"),i+="</div>",i+="</div>",i+='<div class="md-editor">'+u("<div>").text(e).html()+"</div>",i+='<div class="md-preview" style="display:none"></div>')),"function"==typeof u().tooltip&&n.find('[data-mdtooltip="tooltip"]').tooltip({container:"body"});var r=n.find(".md-editor"),b=n.find(".md-preview"),c=n.find(".md-loading");n.css({width:o.width}),r.css({height:o.height,fontSize:o.fontSize}),b.css({height:o.height});var p,m=ace.edit(r[0]);return m.setTheme("ace/theme/"+o.theme),m.getSession().setMode("ace/mode/markdown"),m.getSession().setUseWrapMode(!0),m.getSession().setUseSoftTabs(o.softTabs),m.getSession().on("change",function(){s.val(m.getSession().getValue())}),m.setHighlightActiveLine(!1),m.setShowPrintMargin(!1),m.renderer.setShowGutter(!1),ace.config.loadModule("ace/ext/language_tools",function(){var t,n;p=ace.require("ace/snippets").snippetManager,n=p,(t=m).commands.addCommand({name:"bold",bindKey:{win:"Ctrl-B",mac:"Command-B"},exec:function(t){var e=t.session.getTextRange(t.getSelectionRange());""===e?n.insertSnippet(t,"**${1:text}**"):n.insertSnippet(t,"**"+e+"**")},readOnly:!1}),t.commands.addCommand({name:"italic",bindKey:{win:"Ctrl-I",mac:"Command-I"},exec:function(t){var e=t.session.getTextRange(t.getSelectionRange());""===e?n.insertSnippet(t,"*${1:text}*"):n.insertSnippet(t,"*"+e+"*")},readOnly:!1}),t.commands.addCommand({name:"link",bindKey:{win:"Ctrl-K",mac:"Command-K"},exec:function(t){var e=t.session.getTextRange(t.getSelectionRange());""===e?n.insertSnippet(t,"[${1:text}](http://$2)"):n.insertSnippet(t,"["+e+"](http://$1)")},readOnly:!1})}),o.imageUpload&&(n.find(".md-input-upload").on("change",function(){var t=u(this).get(0).files;f(o.uploadPath,t,m,p,c)}),n.on("dragenter",function(t){t.stopPropagation(),t.preventDefault()}),n.on("dragover",function(t){t.stopPropagation(),t.preventDefault()}),n.on("drop",function(t){t.preventDefault();var e=t.originalEvent.dataTransfer.files;f(o.uploadPath,e,m,p,c)})),!0===o.fullscreen&&u(window).resize(function(){!0===l&&g(!1===d?r:b)}),n.find(".md-btn").click(function(){var t=u(this).data("btn"),e=m.session.getTextRange(m.getSelectionRange());"h1"===t?v(m,"#"):"h2"===t?v(m,"##"):"h3"===t?v(m,"###"):"ul"===t?v(m,"*"):"ol"===t?v(m,"1."):"bold"===t?m.execCommand("bold"):"italic"===t?m.execCommand("italic"):"link"===t?m.execCommand("link"):"image"===t?""===e?p.insertSnippet(m,"![${1:text}](http://$2)"):p.insertSnippet(m,"!["+e+"](http://$1)"):"edit"===t?(d=!1,b.hide(),r.show(),n.find(".btn-edit").addClass("active"),n.find(".btn-preview").removeClass("active"),!0===l&&g(r)):"preview"===t?(d=!0,b.html('<p style="text-align:center; font-size:16px">'+o.label.loading+"...</p>"),o.onPreview(m.getSession().getValue(),function(t){b.html(t)}),r.hide(),b.show(),n.find(".btn-preview").addClass("active"),n.find(".btn-edit").removeClass("active"),!0===l&&g(b)):"fullscreen"===t&&(!0===l?(l=!1,u("body, html").removeClass("md-body-fullscreen"),n.removeClass("md-fullscreen"),r.css("height",o.height),b.css("height",o.height)):(l=!0,u("body, html").addClass("md-body-fullscreen"),n.addClass("md-fullscreen"),g(!1===d?r:b)),m.resize()),m.focus()}),this},content:function(){return ace.edit(this.find(".md-editor")[0]).getSession().getValue()},setContent:function(t){ace.edit(this.find(".md-editor")[0]).setValue(t,1)}};u.fn.markdownEditor=function(t){return e[t]?e[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void u.error("Method "+t+" does not exist on jQuery.markdownEditor"):e.init.apply(this,arguments)},u.fn.markdownEditor.defaults={width:"100%",height:"400px",fontSize:"14px",theme:"tomorrow",softTabs:!0,fullscreen:!0,imageUpload:!1,uploadPath:"",preview:!1,onPreview:function(t,e){e(t)},label:{btnHeader1:"Header 1",btnHeader2:"Header 2",btnHeader3:"Header 3",btnBold:"Bold",btnItalic:"Italic",btnList:"Unordered list",btnOrderedList:"Ordered list",btnLink:"Link",btnImage:"Insert image",btnUpload:"Upload image",btnEdit:"Edit",btnPreview:"Preview",btnFullscreen:"Fullscreen",loading:"Loading"}}}(jQuery);